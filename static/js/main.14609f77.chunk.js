(this["webpackJsonpreact-mesto-auth"]=this["webpackJsonpreact-mesto-auth"]||[]).push([[0],{24:function(e,t,a){e.exports=a.p+"static/media/error.db56ee32.svg"},25:function(e,t,a){e.exports=a.p+"static/media/success.75df9ada.svg"},27:function(e,t,a){e.exports=a.p+"static/media/404.59083296.png"},28:function(e,t,a){e.exports=a.p+"static/media/logo.c6f11019.svg"},31:function(e,t,a){e.exports=a(62)},61:function(e,t,a){},62:function(e,t,a){"use strict";a.r(t);var n=a(0),r=a.n(n),o=a(20),c=a.n(o),i=a(8),l=a(1),s=a(3),u=a(29),m=a(11),p=a(5),d=a.n(p),f=a(10);var h=function(e){var t=e.type,a=void 0===t?"text":t,n=e.placeholder,o=e.name,c=e.required,i=void 0!==c&&c,l=e.length,s=void 0===l?{min:0,max:500}:l,u=e.pattern,m=void 0===u?".*":u,p=e.value,h=void 0===p?"":p,_=e.onInputChange,b=e.optionClasses,v=d()(Object(f.a)({input:!0,input__form:!0},b,b));return r.a.createElement("input",{type:a,className:v,placeholder:n,name:o,required:i,minLength:s.min,maxLength:s.max,pattern:m,value:h,onChange:_})};var _=function(e){var t=e.isActive,a=e.errorText,n=e.optionsClasses,o=void 0===n?"":n;return r.a.createElement("span",{className:"form__input-error ".concat(!t&&"form__input-error_active"," ").concat(o)},a)};var b=function(e){var t,a=e.action,n=e.label,o=e.onBtnClick,c=e.optionalClasses,i=e.text,l=void 0===i?"":i,s=d()((t={btn:!0},Object(f.a)(t,"btn_type_".concat(a),a||!1),Object(f.a)(t,"".concat(c),c),t));return r.a.createElement("button",{type:"button","aria-label":n,className:s,onClick:o},l)},v=a(21),E=a.n(v),g=r.a.createContext();a(57);var O=function(e){var t=e.text,a=e.label,o=e.isActive,c=e.optionsClasses,i=Object(n.useContext)(g),l=d()(Object(f.a)({btn:!0,btn_type_submit:!0,"form__btn-submit":!0,"form__btn-submit_disabled":!o},c,c));return r.a.createElement("button",{type:"submit",className:l,"aria-label":a,disabled:!o},i?r.a.createElement(E.a,{type:"ThreeDots",color:"#ffffff",height:80,width:80,className:"btn__spinner"}):t)},C=r.a.createContext();var j=function(e){var t=e.name,a=e.link,o=e.owner,c=e.likes,i=e._id,l=e.onCardClick,s=e.onCardLike,u=e.onConfirmDelete,m=Object(n.useContext)(C),p=o._id===m._id,f=c.some((function(e){return e._id===m._id})),h=d()({btn_type_like:f,"element__btn-like":!0});return r.a.createElement("div",{className:"element"},r.a.createElement("img",{src:a,alt:t,className:"element__img",onClick:function(){return l({name:t,link:a})}}),r.a.createElement("h2",{className:"element__title"},t)," ",r.a.createElement("span",{className:"element__likes"},c.length),r.a.createElement(b,{action:"not-like",label:"\u043b\u0430\u0439\u043a\u043d\u0443\u0442\u044c",optionalClasses:h,onBtnClick:function(){return s({likes:c,cardId:i})}}),p&&r.a.createElement(b,{action:"trash",label:"\u0443\u0434\u0430\u043b\u0438\u0442\u044c",optionalClasses:"element__btn-trash",onBtnClick:function(){return u({cardId:i})}}))};var k=function(e){var t=e.cards,a=e.onEditAvatar,o=e.onEditProfile,c=e.onAddPlace,i=e.onCardClick,l=e.onCardLike,s=e.onConfirmDelete,u=Object(n.useContext)(C);return r.a.createElement("main",{className:"content"},r.a.createElement("section",{className:"profile"},r.a.createElement("img",{className:"profile__photo",src:u.avatar,alt:"\u0424\u043e\u0442\u043e\u0433\u0440\u0430\u0444\u0438\u044f \u043f\u043e\u043b\u044c\u0437\u043e\u0432\u0430\u0442\u0435\u043b\u044f"}),r.a.createElement(b,{action:"update",label:"\u043e\u0431\u043d\u043e\u0432\u0438\u0442\u044c",optionalClasses:"profile__btn-update",onBtnClick:a}),r.a.createElement("div",{className:"profile__info"},r.a.createElement("h2",{className:"profile__user-name"},u.name),r.a.createElement(b,{action:"edit",label:"\u0440\u0435\u0434\u0430\u043a\u0442\u0438\u0440\u043e\u0432\u0430\u0442\u044c",optionalClasses:"profile__btn-edit",onBtnClick:o}),r.a.createElement("p",{className:"profile__user-hobby"},u.about)),r.a.createElement(b,{action:"add",label:"\u0434\u043e\u0431\u0430\u0432\u0438\u0442\u044c",optionalClasses:"profile__btn-add",onBtnClick:c})),r.a.createElement("section",{className:"elements"},t.map((function(e,t){return r.a.createElement(j,Object.assign({key:"".concat(t,"-").concat(e._id)},e,{onCardClick:i,onCardLike:l,onConfirmDelete:s}))}))))};var y=function(e){var t=e.name,a=e.link,o=e.onClose,c=e.isOpen,i=d()({popup:!0,popup_disabled:!c});return Object(n.useEffect)((function(){var e=function(e){"Escape"===e.key&&o()};return c&&document.addEventListener("keydown",e),function(){return document.removeEventListener("keydown",e)}}),[c,o]),r.a.createElement("section",{className:i,id:"popupCardPreview",onClick:function(e){e.target.classList.contains("popup")&&o()}},r.a.createElement("div",{className:"popup__container"},r.a.createElement("section",{className:"preview-image popup__preview"},r.a.createElement(b,{action:"close",label:"\u0437\u0430\u043a\u0440\u044b\u0442\u044c",optionalClasses:"popup__btn-close preview-image__btn-close",onBtnClick:o}),r.a.createElement("img",{src:a,alt:t,className:"preview-image__img popup__img"}),r.a.createElement("h3",{className:"preview-image__title popup__title"},t))))};var I=function(e){var t=e.name,a=e.title,o=void 0===a?"":a,c=e.isOpen,i=void 0!==c&&c,l=e.onClose,s=e.onSubmitForm,u=e.children,m=d()({popup:!0,popup_disabled:!i}),p=Object(n.useCallback)(l);return Object(n.useEffect)((function(){var e=function(e){"Escape"===e.key&&p()};return i&&document.addEventListener("keydown",e),function(){document.removeEventListener("keydown",e)}}),[i,p]),r.a.createElement("section",{className:m,id:"popup".concat(t),onClick:function(e){e.target.classList.contains("popup")&&l()}},r.a.createElement("div",{className:"popup__container"},r.a.createElement(b,{action:"close",label:"\u0437\u0430\u043a\u0440\u044b\u0442\u044c",optionalClasses:"popup__btn-close",onBtnClick:l}),r.a.createElement("h3",{className:"popup__title"},o),r.a.createElement("form",{name:t,method:"post",action:"#",className:"form popup__form",onSubmit:function(e){e.preventDefault(),s()},noValidate:!0},u)))},N=function(e){var t=arguments.length>1&&void 0!==arguments[1]&&arguments[1],a=Object(n.useState)(e),r=Object(l.a)(a,2),o=r[0],c=r[1],i=Object(n.useState)(""),s=Object(l.a)(i,2),u=s[0],m=s[1],p=Object(n.useState)(t),d=Object(l.a)(p,2),f=d[0],h=d[1],_=Object(n.useState)(null),b=Object(l.a)(_,2),v=b[0],E=b[1],g=Object(n.useState)(!1),O=Object(l.a)(g,2),C=O[0],j=O[1],k=Object(n.useCallback)((function(e){e&&(E(e),j(!0))}),[]),y=Object(n.useCallback)((function(){c(""),m("")}),[]);return Object(n.useEffect)((function(){if(""===o&&(y(),j(!1)),C){var e=v.validationMessage,t=v.validity;e!==u&&m(e),t.valid?h(!0):h(!1)}}),[u,o,y,v,C]),[{inputValue:o,setInputValue:c,isInputValid:f,inputErrorText:u},k,y]};var x=function(e){var t=e.isOpen,a=e.onClose,o=e.onUpdaterUser,c=Object(n.useContext)(C),i=N(c.name,!0),s=Object(l.a)(i,3),u=s[0],m=u.inputValue,p=u.setInputValue,d=u.isInputValid,f=u.inputErrorText,b=s[1],v=s[2],E=N(c.about,!0),g=Object(l.a)(E,3),j=g[0],k=j.inputValue,y=j.setInputValue,x=j.isInputValid,S=j.inputErrorText,U=g[1],V=g[2];Object(n.useEffect)((function(){return p(c.name),y(c.about),function(){v(),V()}}),[c.about,c.name,t,V,v,y,p]);var T={name:function(e){return p(e)},about:function(e){return y(e)}},A={name:function(e){return b(e)},about:function(e){return U(e)}},w=function(e){var t=e.target,a=t.value,n=t.name,r=t.validationMessage,o=t.validity,c=A[n];(0,T[n])(a),c({validationMessage:r,validity:o})};return r.a.createElement(I,{name:"EditForm",title:"\u0420\u0435\u0434\u0430\u043a\u0442\u0438\u0440\u043e\u0432\u0430\u0442\u044c \u043f\u0440\u043e\u0444\u0438\u043b\u044c",isOpen:t,onClose:a,onSubmitForm:function(){return o({name:m,about:k})}},r.a.createElement("label",{className:"form__field"},r.a.createElement(h,{placeholder:"\u0412\u0432\u0435\u0434\u0438\u0442\u0435 \u0438\u043c\u044f",name:"name",length:{min:2,max:40},pattern:"[\u0410-\u042f\u0430-\u044f\u0451\u0401A-Za-z\\s-]*",required:!0,value:m,onInputChange:w}),r.a.createElement(_,{isActive:d,errorText:f})),r.a.createElement("label",{className:"form__field"},r.a.createElement(h,{placeholder:"\u0412\u0432\u0435\u0434\u0438\u0442\u0435 \u0445\u043e\u0431\u0431\u0438",name:"about",length:{min:2,max:200},required:!0,value:k,onInputChange:w}),r.a.createElement(_,{isActive:x,errorText:S})),r.a.createElement(O,{text:"\u0421\u043e\u0445\u0440\u0430\u043d\u0438\u0442\u044c",label:"\u0441\u043e\u0445\u0440\u0430\u043d\u0438\u0442\u044c",isActive:d&&x}))};var S=function(e){var t=e.isOpen,a=e.onClose,o=e.onUpdaterUserAvatar,c=N(""),i=Object(l.a)(c,3),s=i[0],u=s.inputValue,m=s.setInputValue,p=s.isInputValid,d=s.inputErrorText,f=i[1],h=i[2];return Object(n.useEffect)((function(){h()}),[t,h]),r.a.createElement(I,{name:"EditForm",title:"\u0420\u0435\u0434\u0430\u043a\u0442\u0438\u0440\u043e\u0432\u0430\u0442\u044c \u043f\u0440\u043e\u0444\u0438\u043b\u044c",isOpen:t,onClose:a,onSubmitForm:function(){return o({avatar:u})}},r.a.createElement("label",{className:"form__field"},r.a.createElement("input",{type:"url",className:"input input_type_hobby form__input",placeholder:"\u0421\u0441\u044b\u043b\u043a\u0430 \u043d\u0430 \u043d\u043e\u0432\u044b\u0439 \u0430\u0432\u0430\u0442\u0430\u0440",name:"urlAvatar",id:"avatar-input",required:!0,value:u,onChange:function(e){m(e.target.value),f(e.target)}}),r.a.createElement(_,{isActive:p,errorText:d})),r.a.createElement(O,{text:"\u0421\u043e\u0445\u0440\u0430\u043d\u0438\u0442\u044c",label:"\u0441\u043e\u0445\u0440\u0430\u043d\u0438\u0442\u044c",isActive:p}))};var U=function(e){var t=e.isOpen,a=e.onClose,o=e.onPost,c=N(""),i=Object(l.a)(c,3),s=i[0],u=s.inputValue,m=s.setInputValue,p=s.isInputValid,d=s.inputErrorText,f=i[1],b=i[2],v=N(""),E=Object(l.a)(v,3),g=E[0],C=g.inputValue,j=g.setInputValue,k=g.isInputValid,y=g.inputErrorText,x=E[1],S=E[2];Object(n.useEffect)((function(){return function(){b(),S()}}),[t,S,b]);var U={place:function(e){return m(e)},linkPlace:function(e){return j(e)}},V={place:function(e){return f(e)},linkPlace:function(e){return x(e)}},T=function(e){var t=e.target,a=t.value,n=t.name,r=t.validationMessage,o=t.validity,c=V[n];(0,U[n])(a),c({validationMessage:r,validity:o})};return r.a.createElement(I,{name:"AddForm",title:"\u041d\u043e\u0432\u043e\u0435 \u043c\u0435\u0441\u0442\u043e",isOpen:t,onClose:a,onSubmitForm:function(){return o({name:u,link:C})}},r.a.createElement("label",{className:"form__field"},r.a.createElement(h,{placeholder:"\u041d\u0430\u0437\u0432\u0430\u043d\u0438\u0435 \u043c\u0435\u0441\u0442\u0430",name:"place",required:!0,length:{min:1,max:30},value:u,onInputChange:T}),r.a.createElement(_,{isActive:p,errorText:d})),r.a.createElement("label",{className:"form__field"},r.a.createElement(h,{type:"url",placeholder:"\u0421\u0441\u044b\u043b\u043a\u0430 \u043d\u0430 \u043a\u0430\u0440\u0442\u0438\u043d\u043a\u0443",name:"linkPlace",required:!0,value:C,onInputChange:T}),r.a.createElement(_,{isActive:k,errorText:y})),r.a.createElement(O,{text:"\u0421\u043e\u0437\u0434\u0430\u0442\u044c",label:"\u0441\u043e\u0437\u0434\u0430\u0442\u044c",isActive:k&&p}))};var V=function(e){var t=e.isOpen,a=e.onClose,n=e.onDelete;return r.a.createElement(I,{name:"DeleteForm",title:"\u0412\u044b \u0443\u0432\u0435\u0440\u0435\u043d\u044b?",isOpen:t,onClose:a,onSubmitForm:n},r.a.createElement(O,{text:"\u0414\u0430",label:"\u043f\u043e\u0434\u0442\u0432\u0435\u0440\u0434\u0438\u0442\u044c",isActive:!0}))},T=a(22),A=a(23),w=new(function(){function e(t){var a=t.baseUrl,n=t.authUrl;Object(T.a)(this,e),this._baseUrl=a,this._authUrl=n,this._headers={authorization:"71b91625-ec4b-4170-b042-4d00aa6f06b7","Content-Type":"application/json"}}return Object(A.a)(e,[{key:"getInitialData",value:function(){return Promise.all([this._getUserInfo(),this._getInitialCards()])}},{key:"_returnResponse",value:function(e){return e.ok?e.json():Promise.reject("\u041e\u0448\u0438\u0431\u043a\u0430: ".concat(e.status))}},{key:"setToken",value:function(e){this._headers=Object(m.a)(Object(m.a)({},this._headers),{},{authorization:e})}},{key:"regUser",value:function(e){var t=this;return fetch("".concat(this._authUrl,"/signup"),{method:"POST",headers:this._headers,body:JSON.stringify(e)}).then(this._returnResponse).then((function(e){t._id=e._id}))}},{key:"loginUser",value:function(e){return fetch("".concat(this._authUrl,"/signin"),{method:"POST",headers:this._headers,body:JSON.stringify(e)}).then(this._returnResponse)}},{key:"checkUser",value:function(e){return fetch("".concat(this._authUrl,"/users/me"),{method:"GET",headers:Object(m.a)(Object(m.a)({},this._headers),{},{authorization:e})}).then(this._returnResponse)}},{key:"_getInitialCards",value:function(){return fetch("".concat(this._baseUrl,"/cards"),{headers:this._headers}).then(this._returnResponse)}},{key:"_getUserInfo",value:function(){var e=this;return fetch("".concat(this._baseUrl,"/users/me"),{headers:this._headers}).then(this._returnResponse).then((function(t){return e.myId=t._id,t}))}},{key:"updateUserInfo",value:function(e){return fetch("".concat(this._baseUrl,"/users/me"),{method:"PATCH",headers:this._headers,body:JSON.stringify(e)}).then(this._returnResponse)}},{key:"updateUserAvatar",value:function(e){return fetch("".concat(this._baseUrl,"/users/me/avatar"),{method:"PATCH",headers:this._headers,body:JSON.stringify(e)}).then(this._returnResponse)}},{key:"postCard",value:function(e){return fetch("".concat(this._baseUrl,"/cards"),{method:"POST",headers:this._headers,body:JSON.stringify(e)}).then(this._returnResponse)}},{key:"deleteCard",value:function(e){var t=e.cardId;return fetch("".concat(this._baseUrl,"/cards/").concat(t),{method:"DELETE",headers:this._headers}).then(this._returnResponse)}},{key:"likeCard",value:function(e){var t=e.isLiked,a=e.cardId;return fetch("".concat(this._baseUrl,"/cards/likes/").concat(a),{method:t?"DELETE":"PUT",headers:this._headers}).then(this._returnResponse).then((function(e){return e.likes}))}}]),e}())({baseUrl:"https://mesto.nomoreparties.co/v1/cohort-12",authUrl:"https://auth.nomoreparties.co"}),P=a(24),L=a.n(P),D=a(25),R=a.n(D);var B=function(e){var t=e.isOpen,a=e.onClose,n=e.type,o=void 0===n?"success":n,c=d()({tooltip:!0,tooltip_disabled:!t}),i="success"===o?"\u0412\u044b \u0443\u0441\u043f\u0435\u0448\u043d\u043e\n      \u0437\u0430\u0440\u0435\u0433\u0438\u0441\u0442\u0440\u0438\u0440\u043e\u0432\u0430\u043b\u0438\u0441\u044c!":"\u0427\u0442\u043e-\u0442\u043e \u043f\u043e\u0448\u043b\u043e \u043d\u0435 \u0442\u0430\u043a! \u041f\u043e\u043f\u0440\u043e\u0431\u0443\u0439\u0442\u0435 \u0435\u0449\u0451 \u0440\u0430\u0437.",l="success"===o?R.a:L.a,s="success"===o?"successImg":"errorImg";return r.a.createElement("section",{className:c},r.a.createElement("div",{className:"tooltip__container"},r.a.createElement(b,{action:"close",label:"\u0437\u0430\u043a\u0440\u044b\u0442\u044c",optionalClasses:"tooltip__btn-close",onBtnClick:a}),r.a.createElement("img",{src:l,alt:s,className:"tooltip__img"}),r.a.createElement("h3",{className:"tooltip__title"},i)))},M=r.a.createContext(),q=r.a.createContext(),F=r.a.createContext(),J=r.a.createContext(),z=function(){return Object(n.useContext)(M)},H=function(){return Object(n.useContext)(q)},G=function(){return Object(n.useContext)(F)},Z=function(){return Object(n.useContext)(J)},K=function(e){var t=e.children,a=Object(n.useState)(!1),o=Object(l.a)(a,2),c=o[0],i=o[1],s=Object(n.useState)(!1),u=Object(l.a)(s,2),m=u[0],p=u[1];return r.a.createElement(q.Provider,{value:c},r.a.createElement(M.Provider,{value:m},r.a.createElement(J.Provider,{value:function(){return i((function(e){return!e}))}},r.a.createElement(F.Provider,{value:function(){return p((function(e){return!e}))}},t))))};var Q=function(){var e=Object(n.useState)(!1),t=Object(l.a)(e,2),a=t[0],o=t[1],c=Object(n.useState)(!1),i=Object(l.a)(c,2),s=i[0],p=i[1],d=Object(n.useState)(!1),f=Object(l.a)(d,2),h=f[0],_=f[1],b=Object(n.useState)(!1),v=Object(l.a)(b,2),E=v[0],O=v[1],j=Object(n.useState)(!1),I=Object(l.a)(j,2),N=I[0],T=I[1],A=Object(n.useState)(!1),P=Object(l.a)(A,2),L=P[0],D=P[1],R=Object(n.useState)(null),M=Object(l.a)(R,2),q=M[0],F=M[1],J=Object(n.useState)(""),z=Object(l.a)(J,2),G=z[0],K=z[1],Q=Object(n.useState)({}),W=Object(l.a)(Q,2),X=W[0],Y=W[1],$=Object(n.useState)([]),ee=Object(l.a)($,2),te=ee[0],ae=ee[1],ne=H(),re=Z();Object(n.useEffect)((function(){w.getInitialData().then((function(e){var t=Object(l.a)(e,2),a=t[0],n=t[1];Y(a),ae(n)})).catch((function(e){return console.log("\u041e\u0448\u0438\u0431\u043a\u0430: ".concat(e))}))}),[]);var oe=function(){p(!1),_(!1),O(!1),T(!1),D(!1)};return r.a.createElement(r.a.Fragment,null,r.a.createElement(C.Provider,{value:X},r.a.createElement(k,{cards:te,onEditProfile:function(){return p(!0)},onAddPlace:function(){return O(!0)},onEditAvatar:function(){return _(!0)},onCardClick:function(e){F(e),D(!0)},onCardLike:function(e){var t=e.likes,a=e.cardId,n=t.some((function(e){return e._id===X._id}));w.likeCard({isLiked:n,cardId:a}).then((function(e){var t=te.map((function(t){return t._id===a?Object(m.a)(Object(m.a)({},t),{},{likes:e}):t}));ae(t)})).catch((function(e){return console.log("\u041e\u0448\u0438\u0431\u043a\u0430: ".concat(e))}))},onConfirmDelete:function(e){var t=e.cardId;T(!0),K(t)}}),r.a.createElement(y,Object.assign({},q,{isOpen:L,onClose:oe})),r.a.createElement(g.Provider,{value:a},r.a.createElement(x,{isOpen:s,onClose:oe,onUpdaterUser:function(e){var t=e.name,a=e.about;o(!0),w.updateUserInfo({name:t,about:a}).then((function(e){Y(e),oe(),o(!1)})).catch((function(e){return console.log("\u041e\u0448\u0438\u0431\u043a\u0430: ".concat(e))}))}}),r.a.createElement(S,{isOpen:h,onClose:oe,onUpdaterUserAvatar:function(e){var t=e.avatar;o(!0),w.updateUserAvatar({avatar:t}).then((function(e){Y(e),oe(),o(!1)})).catch((function(e){return console.log("\u041e\u0448\u0438\u0431\u043a\u0430: ".concat(e))}))}}),r.a.createElement(U,{isOpen:E,onClose:oe,onPost:function(e){var t=e.name,a=e.link;o(!0),w.postCard({name:t,link:a}).then((function(e){ae([e].concat(Object(u.a)(te))),oe(),o(!1)})).catch((function(e){return console.log("\u041e\u0448\u0438\u0431\u043a\u0430: ".concat(e))}))}}),r.a.createElement(V,{isOpen:N,onClose:oe,onDelete:function(){o(!0),w.deleteCard({cardId:G}).then((function(){var e=te.filter((function(e){return e._id!==G}));ae(e),oe(),o(!1)})).catch((function(e){return console.log("\u041e\u0448\u0438\u0431\u043a\u0430: ".concat(e))}))}}),r.a.createElement(B,{isOpen:ne,onClose:re}))))};var W=function(e){var t=e.history,a=z(),n=G(),o=H(),c=Z(),s=N(""),u=Object(l.a)(s,2),m=u[0],p=m.inputValue,d=m.setInputValue,f=m.isInputValid,b=m.inputErrorText,v=u[1],E=N(""),g=Object(l.a)(E,2),C=g[0],j=C.inputValue,k=C.setInputValue,y=C.isInputValid,I=C.inputErrorText,x=g[1],S={email:function(e){return d(e)},password:function(e){return k(e)}},U={email:function(e){return v(e)},password:function(e){return x(e)}},V=function(e){var t=e.target,a=t.value,n=t.name,r=t.validationMessage,o=t.validity,c=U[n];(0,S[n])(a),c({validationMessage:r,validity:o})};return r.a.createElement("div",{className:"auth"},r.a.createElement("div",{className:"auth__wrapper"},r.a.createElement("h3",{className:"auth__title"},"\u0420\u0435\u0433\u0438\u0441\u0442\u0440\u0430\u0446\u0438\u044f"),r.a.createElement("form",{method:"post",action:"#",className:"form form_type_auth auth__form",noValidate:!0,onSubmit:function(e){e.preventDefault(),w.regUser({email:p,password:j}).then((function(e){console.log(e),t.push("/sign-in"),c()})).catch((function(e){console.log(e),n()}))}},r.a.createElement("label",{className:"form__field form__field_auth"},r.a.createElement(h,{type:"email",placeholder:"Email",name:"email",required:!0,value:p,onInputChange:V,optionClasses:"auth__input"}),r.a.createElement(_,{isActive:f,errorText:b,optionsClasses:"form__input-error_auth"})),r.a.createElement("label",{className:"form__field form__field_auth"},r.a.createElement(h,{type:"password",placeholder:"\u041f\u0430\u0440\u043e\u043b\u044c",name:"password",required:!0,value:j,onInputChange:V,optionClasses:"auth__input"}),r.a.createElement(_,{isActive:y,errorText:I})),r.a.createElement(O,{isActive:f&&y,text:"\u0437\u0430\u0440\u0435\u0433\u0438\u0441\u0442\u0440\u0438\u0440\u043e\u0432\u0430\u0442\u044c\u0441\u044f",label:"\u0437\u0430\u0440\u0435\u0433\u0438\u0441\u0442\u0440\u0438\u0440\u043e\u0432\u0430\u0442\u044c\u0441\u044f",optionsClasses:"btn_auth"})),r.a.createElement(i.c,{to:"/sign-in",className:"auth__link"},"\u0423\u0436\u0435 \u0437\u0430\u0440\u0435\u0433\u0438\u0441\u0442\u0440\u0438\u0440\u043e\u0432\u0430\u043d\u044b? \u0412\u043e\u0439\u0442\u0438")),r.a.createElement(B,{isOpen:o,onClose:c}),r.a.createElement(B,{isOpen:a,onClose:function(){d(""),k(""),n()},type:"error"}))},X=function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"",a=Object(n.useState)((function(){return localStorage.getItem(e)||t})),r=Object(l.a)(a,2),o=r[0],c=r[1];return Object(n.useEffect)((function(){localStorage.setItem(e,o)}),[o,e]),[o,c]};var Y=function(e){var t=e.loggedIn,a=e.onLoggedIn,n=e.checkToken,o=X("jwt"),c=Object(l.a)(o,2)[1],u=z(),m=H(),p=G(),d=Z(),f=N(""),b=Object(l.a)(f,2),v=b[0],E=v.inputValue,g=v.setInputValue,C=v.isInputValid,j=v.inputErrorText,k=b[1],y=N(""),I=Object(l.a)(y,2),x=I[0],S=x.inputValue,U=x.setInputValue,V=x.isInputValid,T=x.inputErrorText,A=I[1],P={email:function(e){return g(e)},password:function(e){return U(e)}},L={email:function(e){return k(e)},password:function(e){return A(e)}},D=function(e){var t=e.target,a=t.value,n=t.name,r=t.validationMessage,o=t.validity,c=L[n];(0,P[n])(a),c({validationMessage:r,validity:o})};return t?r.a.createElement(s.a,{to:"/"}):r.a.createElement("div",{className:"auth"},r.a.createElement("div",{className:"auth__wrapper"},r.a.createElement("h3",{className:"auth__title"},"\u0412\u0445\u043e\u0434"),r.a.createElement("form",{method:"post",action:"#",className:"form form_type_auth auth__form",noValidate:!0,onSubmit:function(e){e.preventDefault(),w.loginUser({email:E,password:S}).then((function(e){var t=e.token;return c(t),a(!0),d(),t})).then(n).catch((function(e){console.log(e),p()}))}},r.a.createElement("label",{className:"form__field form__field_auth"},r.a.createElement(h,{type:"email",placeholder:"Email",name:"email",required:!0,value:E,onInputChange:D,optionClasses:"auth__input"}),r.a.createElement(_,{isActive:C,errorText:j,optionsClasses:"form__input-error_auth"})),r.a.createElement("label",{className:"form__field form__field_auth"},r.a.createElement(h,{type:"password",placeholder:"\u041f\u0430\u0440\u043e\u043b\u044c",name:"password",required:!0,value:S,onInputChange:D,optionClasses:"auth__input"}),r.a.createElement(_,{isActive:V,errorText:T})),r.a.createElement(O,{isActive:C&&V,text:"\u0432\u043e\u0439\u0442\u0438",label:"\u0432\u043e\u0439\u0442\u0438",optionsClasses:"btn_auth"})),r.a.createElement(i.c,{to:"/sign-up",className:"auth__link"},"\u0415\u0449\u0435 \u043d\u0435 \u0437\u0430\u0440\u0435\u0433\u0438\u0441\u0442\u0440\u0438\u0440\u043e\u0432\u0430\u043d\u044b? \u0420\u0435\u0433\u0438\u0441\u0442\u0440\u0430\u0446\u0438\u044f")),r.a.createElement(B,{isOpen:m,onClose:d}),r.a.createElement(B,{isOpen:u,onClose:function(){g(""),U(""),p()},type:"error"}))};a(27);var $=a(28),ee=a.n($);var te=Object(s.g)((function(e){var t=e.onLogout,a=e.history,n=e.location,o=e.userInfo,c=e.loggedIn,l="/sign-in"===n.pathname,s="/"===n.pathname;return r.a.createElement("header",{className:"header"},r.a.createElement("img",{src:ee.a,alt:"\u0418\u0437\u043e\u0431\u0440\u0430\u0436\u0435\u043d\u0438\u0435 \u043b\u043e\u0433\u043e\u0442\u0438\u043f\u0430 \u0441\u043e\u0446\u0438\u0430\u043b\u044c\u043d\u043e\u0439 \u0441\u0435\u0442\u0438 Mesto Russia",className:"logo header__logo "}),!c&&r.a.createElement("div",{className:"header__nav"},r.a.createElement(i.c,{to:l?"/sign-up":"/sign-in",className:"header__link"},l?"\u0420\u0435\u0433\u0438\u0441\u0442\u0440\u0430\u0446\u0438\u044f":"\u0412\u043e\u0439\u0442\u0438")),s&&c&&o&&r.a.createElement("div",{className:"header__nav"},r.a.createElement("span",{className:"header__email"},o.email),r.a.createElement(b,{text:"\u0412\u044b\u0439\u0442\u0438",label:"\u0432\u044b\u0439\u0442\u0438",action:"header",onBtnClick:function(){t(),a.push("/sign-in")}})))}));var ae=function(){return r.a.createElement("footer",{className:"footer"},r.a.createElement("span",{className:"footer__copyright"},"\xa9 2020 Mesto Russia"))},ne=a(30),re=function(e){var t=e.component,a=Object(ne.a)(e,["component"]);return r.a.createElement(s.b,null,(function(){return a.loggedIn&&a.tokenValid?r.a.createElement(t,a):r.a.createElement(s.a,{to:"/sign-in"})}))};var oe=Object(s.g)((function(e){var t=e.history,a=e.location.pathname,o=X("jwt"),c=Object(l.a)(o,2),i=c[0],u=c[1],m=Object(n.useState)(!1),p=Object(l.a)(m,2),d=p[0],f=p[1],h=Object(n.useState)(null),_=Object(l.a)(h,2),b=_[0],v=_[1],E=Object(n.useState)(!1),g=Object(l.a)(E,2),O=g[0],C=g[1],j=Object(n.useState)(!1),k=Object(l.a)(j,2),y=k[0],I=k[1],N=Object(n.useCallback)((function(e){e||(e=i),w.checkUser("Bearer ".concat(e)).then((function(e){var t=e.data;f(!0),C(!0),I(!0),v(t)})).catch((function(e){console.log("\u041e\u0448\u0438\u0431\u043a\u0430",e)}))}),[i]);return Object(n.useEffect)((function(){i&&!O&&N()}),[i,d,a,b,O,t,N]),r.a.createElement("div",{className:"page"},r.a.createElement(te,{userInfo:b,onLogout:function(){u(""),C(!1),I(!1),f(!1)},loggedIn:d}),r.a.createElement(s.d,null,r.a.createElement(K,null,r.a.createElement(re,{exact:!0,path:"/",component:Q,loggedIn:d,tokenValid:y}),r.a.createElement(s.b,{path:"/sign-in",render:function(e){return r.a.createElement(Y,Object.assign({},e,{onLoggedIn:f,loggedIn:d,checkToken:N}))}}),r.a.createElement(s.b,{path:"/sign-up",render:function(e){return r.a.createElement(W,Object.assign({},e,{onLoggedIn:f,loggedIn:d}))}}))),r.a.createElement(ae,null),r.a.createElement(B,null))})),ce=r.a.createContext(),ie=ce.Provider;ce.Consumer,a(61);c.a.render(r.a.createElement(r.a.StrictMode,null,r.a.createElement(ie,{value:w},r.a.createElement(i.a,null,r.a.createElement(oe,null)))),document.getElementById("root"))}},[[31,1,2]]]);
//# sourceMappingURL=main.14609f77.chunk.js.map